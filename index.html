<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Coco & Ollie Allergy & Meal Planner</title>

<style>
:root{
  --bg:#0f172a;
  --card:#111c2e;
  --border:#22304a;
  --text:#e6edf6;
  --muted:#94a3b8;
  --red:#ef4444;
  --yellow:#facc15;
  --blue:#3b82f6;
}

body{
  margin:0;
  background:linear-gradient(180deg,#0b1220,#0f172a);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
}

.wrap{max-width:1100px;margin:auto;padding:20px}

h1{margin:0 0 12px 0;font-size:22px}

.tabs{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:18px}

.tab{
  padding:8px 14px;
  border-radius:10px;
  background:#0b1426;
  border:1px solid var(--border);
  cursor:pointer;
  font-weight:600;
}

.tab.active{border-color:var(--blue)}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:18px;
  margin-bottom:18px;
}

textarea,input{
  width:100%;
  border-radius:12px;
  border:1px solid var(--border);
  background:#0b1426;
  color:var(--text);
  padding:12px;
  margin-bottom:10px;
}

button{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#0b1426;
  color:var(--text);
  cursor:pointer;
  margin-right:6px;
  margin-bottom:6px;
}

button:hover{border-color:var(--blue)}

.red{color:var(--red)}
.yellow{color:var(--yellow)}
.small{font-size:12px;color:var(--muted)}
.hidden{display:none}
.banner{padding:10px;border-radius:12px;margin-bottom:10px;font-weight:600}
.banner.red{background:rgba(239,68,68,.15)}
.banner.yellow{background:rgba(250,204,21,.15)}
.banner.green{background:rgba(34,197,94,.15)}
.entry{margin-bottom:6px}
</style>
</head>

<body>
<div class="wrap">

<h1>Coco & Ollie Allergy & Meal Planner</h1>

<div class="tabs">
  <div class="tab active" onclick="switchTab('scanner')">Scanner</div>
  <div class="tab" onclick="switchTab('master')">Master List</div>
  <div class="tab" onclick="switchTab('shared')">Shared Safe</div>
  <div class="tab" onclick="switchTab('meal')">Meal Builder</div>
</div>

<!-- SCANNER -->
<div id="scanner" class="card">
<textarea id="ingredients" placeholder="Paste ingredients here..."></textarea>
<button onclick="analyze()">Analyze</button>
<button onclick="demo()">Demo</button>
<button onclick="testProtein('Chicken')">Test Chicken</button>
<button onclick="testProtein('Turkey')">Test Turkey</button>
<button onclick="testProtein('Beef')">Test Beef</button>
<div id="scanResults"></div>
</div>

<!-- MASTER -->
<div id="master" class="card hidden">
<input type="text" id="searchBox" placeholder="Search ingredient, dog name, or reaction level..." oninput="filterMaster()">
<div id="foodList"></div>
<details style="margin-top:14px">
<summary>Environmental / Metals / Nutrition</summary>
<div id="envList" style="margin-top:10px"></div>
</details>
</div>

<!-- SHARED SAFE -->
<div id="shared" class="card hidden">
<h3>Shared Safe Ingredients (LOW for BOTH)</h3>
<div id="sharedSafeList"></div>
</div>

<!-- MEAL BUILDER -->
<div id="meal" class="card hidden">
<h3>Generate Balanced Meal</h3>
<button onclick="generateMeal()">Generate Meal</button>
<div id="mealOutput"></div>
<div class="small" style="margin-top:12px">
Always include a canine multivitamin & calcium source when feeding homemade meals.
Consult your vet for long-term diet plans.
</div>
</div>

</div>

<script>

/* FULL DATA */

const DATA={
Coco:{
High:["Cheese - Goat","Chicken Eggs","Coconut Milk","Oat flour","Potato flour","E 220 Sulphur dioxide","Copper"],
Moderate:["Beef","Lamb","Sesame Oil","E 211 Sodium benzoate","E 621 Monosodium glutamate","Calcium","Zinc"],
Low:["Chicken","Turkey","Rice","Carrot"]
},
Ollie:{
High:["Coconut Oil","Duck Liver","Venison Meal","E 951 Aspartame","Copper"],
Moderate:["Sweet Potato","Soy Flour","E 249 Potassium nitrite","Calcium","Iron"],
Low:["Chicken","Turkey","Rice","Carrot"]
}
};

/* MERGE */

function mergeData(){
let map={};
["Coco","Ollie"].forEach(dog=>{
["High","Moderate"].forEach(level=>{
DATA[dog][level].forEach(item=>{
let key=item.toLowerCase();
if(!map[key]) map[key]={name:item,dogs:[],level};
map[key].dogs.push(dog);
if(level==="High") map[key].level="High";
});
});
});
return map;
}

const MASTER=mergeData();

/* SCANNER */

function analyze(){
let text=document.getElementById("ingredients").value.toLowerCase();
let results="";
let highCount=0,modCount=0;

Object.values(MASTER).forEach(item=>{
if(text.includes(item.name.toLowerCase())){
let color=item.level==="High"?"red":"yellow";
if(item.level==="High") highCount++;
else modCount++;
results+=`<div class="${color}">${item.name} — ${item.dogs.join(" + ")} (${item.level})</div>`;
}
});

let bannerClass="green";
let bannerText="SAFE – No High or Moderate matches";

if(highCount){bannerClass="red";bannerText="AVOID – High reaction detected";}
else if(modCount){bannerClass="yellow";bannerText="CAUTION – Moderate reactions present";}

document.getElementById("scanResults").innerHTML=
`<div class="banner ${bannerClass}">${bannerText}</div>
<div class="small">High: ${highCount} | Moderate: ${modCount}</div>
${results||"<div class='small'>No matches found.</div>"}`;
}

function demo(){
document.getElementById("ingredients").value=
"Ingredients: beef, coconut oil, rice, chicken eggs, carrot.";
}

function testProtein(p){
document.getElementById("ingredients").value=p;
analyze();
}

/* MASTER */

function renderMaster(){
let foodHTML="";
Object.values(MASTER).forEach(item=>{
let color=item.level==="High"?"red":"yellow";
foodHTML+=`<div class="entry ${color}" data-search="${item.name} ${item.dogs.join(" ")} ${item.level}">
${item.name} — ${item.dogs.join(" + ")} (${item.level})
</div>`;
});
document.getElementById("foodList").innerHTML=foodHTML;
}

renderMaster();

function filterMaster(){
let term=document.getElementById("searchBox").value.toLowerCase();
document.querySelectorAll("#master .entry").forEach(e=>{
e.style.display=e.dataset.search.toLowerCase().includes(term)?"block":"none";
});
}

/* SHARED SAFE */

function renderShared(){
let shared=DATA.Coco.Low.filter(item=>
DATA.Ollie.Low.includes(item) &&
!DATA.Coco.High.includes(item) &&
!DATA.Coco.Moderate.includes(item) &&
!DATA.Ollie.High.includes(item) &&
!DATA.Ollie.Moderate.includes(item)
);

document.getElementById("sharedSafeList").innerHTML=
shared.map(i=>`<div>${i}</div>`).join("")||
"<div class='small'>No shared safe items.</div>";
}

renderShared();

/* MEAL BUILDER */

function generateMeal(){
let proteins=["Chicken","Turkey"];
let carbs=["Rice"];
let veg=["Carrot"];

let protein=proteins[Math.floor(Math.random()*proteins.length)];
let carb=carbs[0];
let veggie=veg[0];

document.getElementById("mealOutput").innerHTML=
`<div><strong>Protein:</strong> ${protein}</div>
<div><strong>Carb:</strong> ${carb}</div>
<div><strong>Vegetable:</strong> ${veggie}</div>
<div style="margin-top:8px" class="small">
Add: Omega-3 source + calcium supplement + canine multivitamin.
</div>`;
}

/* TABS */

function switchTab(tab){
document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
event.target.classList.add("active");
["scanner","master","shared","meal"].forEach(id=>{
document.getElementById(id).classList.add("hidden");
});
document.getElementById(tab).classList.remove("hidden");
}

</script>
</body>
</html>
